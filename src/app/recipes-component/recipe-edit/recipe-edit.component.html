<div class="row justify-content-center">
  <div class="col-12">
    <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
      <div class="card-header bg-white border-0 pt-4 px-4">
        <h2 class="m-0">{{ editMode ? 'Edit Recipe' : 'New Recipe' }}</h2>
      </div>
      <div class="card-body p-4">
        <form [formGroup]="recipeForm" (ngSubmit)="onSubmit()">
          <div class="row g-4">
            <!-- Basic Info -->
            <div class="col-md-8">
              <div class="mb-3">
                <label for="name" class="form-label fw-bold text-muted small text-uppercase">Recipe Name</label>
                <input type="text" class="form-control" id="name" placeholder="Enter recipe name" formControlName="name" required>
              </div>
              <div class="mb-3">
                <label for="imagePath" class="form-label fw-bold text-muted small text-uppercase">Image URL</label>
                <input type="text" class="form-control" id="imagePath" placeholder="Paste image link" formControlName="imagePath" #imagePath>
              </div>
            </div>

            <!-- Image Preview -->
            <div class="col-md-4">
              <label class="form-label fw-bold text-muted small text-uppercase d-block">Preview</label>
              <div class="preview-container bg-light rounded-3 d-flex align-items-center justify-content-center overflow-hidden" style="height: 150px; border: 2px dashed #dee2e6;">
                <img *ngIf="imagePath.value" [src]="imagePath.value" class="img-fluid h-100 w-100 object-fit-cover" alt="Preview">
                <i *ngIf="!imagePath.value" class="fas fa-image fa-3x text-muted opacity-25"></i>
              </div>
            </div>

            <div class="col-12">
              <label for="description" class="form-label fw-bold text-muted small text-uppercase">Description</label>
              <textarea class="form-control" id="description" formControlName="description" rows="2" placeholder="Short description of the dish..."></textarea>
            </div>

            <!-- Ingredients -->
            <div class="col-12" formArrayName="ingredients">
              <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                <h4 class="m-0"><i class="fas fa-basket-shopping text-accent me-2"></i> Ingredients</h4>
                <button class="btn btn-outline-success btn-sm rounded-pill px-3" type="button" (click)="onAddIngredient()">
                  <i class="fas fa-plus me-1"></i> Add
                </button>
              </div>

              <div class="row g-2 mb-2 d-none d-md-flex text-muted small fw-bold text-uppercase">
                <div class="col-md-5">Ingredient Name</div>
                <div class="col-md-3">Amount</div>
                <div class="col-md-3">Unit</div>
                <div class="col-md-1"></div>
              </div>

              <div class="row g-2 mb-3 align-items-center" *ngFor="let ingredientCtrl of controls; let i = index" [formGroupName]="i">
                <div class="col-md-5">
                  <input type="text" class="form-control form-control-sm" formControlName="name" placeholder="Ingredient name">
                </div>
                <div class="col-6 col-md-3">
                  <input type="number" class="form-control form-control-sm" formControlName="amount" placeholder="Qty" min="0" step="any">
                </div>
                <div class="col-6 col-md-3">
                  <input type="text" class="form-control form-control-sm" formControlName="uom" placeholder="Unit">
                </div>
                <div class="col-md-1 text-end">
                  <button type="button" class="btn btn-link text-danger p-0 shadow-none" (click)="onDeleteIngredient(i)" title="Remove">
                    <i class="fas fa-trash-can"></i>
                  </button>
                </div>
              </div>
            </div>

            <!-- Instructions -->
            <div class="col-12">
              <label for="instructions" class="form-label fw-bold text-muted small text-uppercase">Preparation and Cooking Instructions</label>
              <div class="alert alert-light border-0 small py-2">
                <i class="fas fa-lightbulb text-accent me-2"></i>
                <strong>Pro Tip:</strong> End each sentence with a period (.) to create a new step automatically.
              </div>
              <textarea class="form-control" id="instructions" formControlName="instructions" rows="6" placeholder="1. Boil water. 2. Add pasta..."></textarea>
            </div>

            <!-- Actions -->
            <div class="col-12 mt-5 pt-3 border-top d-flex gap-2">
              <button type="submit" class="btn btn-success px-5 rounded-pill" [disabled]="!recipeForm.valid">
                <i class="fas fa-save me-2"></i> Save Recipe
              </button>
              <button type="button" class="btn btn-outline-secondary px-5 rounded-pill" (click)="onCancel()">
                Cancel
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
