<div class="row">
  <div class="col-xs-12">
    <img [src]="recipe.imagePath" class="img-fluid" alt="{{recipe.name}}"
      style="height: 300px; width: 300px; padding-top: 10px;">
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <h1>{{recipe.name}}</h1>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    "{{recipe.description}}"
  </div>
</div>
<div class="row" style="margin-left: -50px;">
  <div class="col-xs-12">
    <div class="btn-group">
      <ul ngbDropdown class="dropdown">
        <button class="btn btn-primary dropdown-toggle" ngbDropdownToggle id="dropdownMenuButton1"
          aria-expanded="false">
          Edit This Recipe
        </button>
        <ul ngbDropdownMenu aria-labelledby="dropdownMenuButton1">
          <li><a ngbDropdownItem style="cursor: pointer" (click)="onAddToShoppingList()">Add Ingredients to shopping
              list</a>
          </li>
          <li><a ngbDropdownItem (click)="onEditRecipe()">Edit recipe</a></li>
          <li><a ngbDropdownItem style="cursor: pointer" (click)="onPrintRecipe()">Print recipe</a></li>
          <li><a ngbDropdownItem (click)="onDeleteRecipe()">Delete recipe</a></li>
        </ul>
      </ul>
    </div>

  </div>
</div>
<div class="row" style="padding-bottom: 10px;">
  <div class="col-xs-12">
    <h4 style="text-decoration: underline; margin-bottom: 15px;">Preparation and Cooking Instructions:</h4>

    <!-- Display as numbered steps -->
    <div class="recipe-steps">
      <div *ngFor="let step of getRecipeSteps(); let i = index" class="step-item mb-3">
        <div class="d-flex">
          <div class="step-number">
            <span class="badge bg-primary rounded-circle me-3">{{ step.stepNumber }}</span>
          </div>
          <div class="step-content flex-grow-1">
            <p class="mb-1">{{ step.instruction }}</p>
            <div *ngIf="step.estimatedTime || step.temperature" class="step-meta">
              <small class="text-muted">
                <span *ngIf="step.estimatedTime" class="me-3">
                  <i class="fas fa-clock"></i> {{ step.estimatedTime }}
                </span>
                <span *ngIf="step.temperature">
                  <i class="fas fa-thermometer-half"></i> {{ step.temperature }}
                </span>
              </small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Print-friendly complete recipe layout (hidden by default) -->
    <div class="print-only">
      <!-- Print Recipe Header -->
      <div class="print-recipe-header print-section">
        <div class="print-recipe-title">{{ recipe.name }}</div>
        <div class="print-recipe-description">{{ recipe.description }}</div>
        <div style="margin-top: 10px; font-size: 10pt;">
          Printed on {{ getCurrentDate() }}
        </div>
      </div>

      <!-- Print Ingredients Section -->
      <div class="print-ingredients print-section">
        <h4>Ingredients</h4>
        <ul>
          <li *ngFor="let ingredient of recipe.ingredients">
            <strong>{{ ingredient.amount }} {{ ingredient.uom }}</strong> {{ ingredient.name }}
          </li>
        </ul>
      </div>

      <!-- Print Instructions Section -->
      <div class="print-instructions print-section">
        <h4>Instructions</h4>
        <ol class="recipe-steps-print">
          <li *ngFor="let step of getRecipeSteps()">
            {{ step.instruction }}
            <span *ngIf="step.estimatedTime || step.temperature" class="step-meta-print">
              <br>({{ step.estimatedTime }}{{ step.estimatedTime && step.temperature ? ', ' : '' }}{{ step.temperature }})
            </span>
          </li>
        </ol>
      </div>

      <!-- Print Recipe Footer -->
      <div class="print-recipe-footer">
        <div>From the Pottorff Family Recipe Book</div>
        <div>Enjoy your cooking!</div>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <h4 style="text-decoration: underline; margin-bottom: 15px;">Ingredients:</h4>
    <div class="ingredients-container">
      <div class="ingredient-item" *ngFor="let ingredient of recipe.ingredients; let i = index">
        <div class="ingredient-content">
          <div class="ingredient-info">
            <strong>{{ingredient.amount}} {{ingredient.uom}}</strong> {{ingredient.name}}
          </div>
          <div class="ingredient-actions">
            <button
              class="btn btn-sm btn-outline-success"
              (click)="onAddIngredientToShoppingList(ingredient, i)"
              [id]="'ingredient-btn-' + i"
              title="Add to shopping list">
              <i class="fas fa-cart-plus"></i>
              <span class="d-none d-sm-inline ms-1">Add</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add all ingredients button -->
    <div class="mt-3">
      <button
        class="btn btn-success"
        (click)="onAddAllIngredientsToShoppingList()"
        title="Add all ingredients to shopping list">
        <i class="fas fa-cart-plus me-2"></i>
        Add All Ingredients to Shopping List
      </button>
    </div>
  </div>
</div>

<!-- Toast Notifications -->
<div class="toast-container">
  <div class="toast" [class.show]="showToast" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="toast-header">
      <i class="fas fa-check-circle me-2"></i>
      <strong class="me-auto">Added to Shopping List</strong>
      <button type="button" class="btn-close btn-close-white" (click)="hideToast()" aria-label="Close"></button>
    </div>
    <div class="toast-body">
      {{ toastMessage }}
    </div>
  </div>
</div>
